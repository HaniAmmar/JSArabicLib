<!DOCTYPE html>
<html lang="ar" dir="rtl" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <title>أدوات للغة العربية</title>
</head>

<body>
    <div id="main">
        <fieldset class="options">
            <legend>الخيارات:</legend>
            <input type="radio" id="ImproveText" name="options" value="0" checked="checked" />
            <label for="ImproveText">تحسين النص.</label>
            <input type="radio" id="RemoveAllTashkil" name="options" value="1" />
            <label for="RemoveAllTashkil">إزالة كامل التشكيل.</label>
            <input type="radio" id="ReduceTashkil" name="options" value="2" />
            <label for="ReduceTashkil">تخفيف التشكيل.</label>
            <input type="radio" id="RemoveTashkilKeepShadda" name="options" value="3" />
            <label for="RemoveTashkilKeepShadda">إزالة التشكيل عدا الشدة.</label>
            <input type="radio" id="RemoveLastTashkil" name="options" value="4" />
            <label for="RemoveLastTashkil">إزالة تشكيل آخر حرف.</label>
            <input type="radio" id="KeepLastTashkilOnly" name="options" value="5" />
            <label for="KeepLastTashkilOnly">ابقاء تشكيل الحرف الآخير.</label>
            <input type="radio" id="RemoveTatweel" name="options" value="6" />
            <label for="RemoveTatweel">إزالة التطويل.</label>
            <input type="radio" id="EncodeTashkil" name="options" value="8" />
            <label for="EncodeTashkil">ترميز التشكيل.</label>
            <input type="radio" id="DecodeTashkil" name="options" value="9" />
            <label for="DecodeTashkil">دمج التشكيل.</label>
            <input type="radio" id="SeparateLamAlef" name="options" value="10" />
            <label for="SeparateLamAlef">فصل اللام عن الألف.</label>
            <input type="radio" id="UnifyLetters" name="options" value="11" />
            <label for="UnifyLetters">توحيد الحروف.</label>
            <input type="radio" id="SimplifyText" name="options" value="12" />
            <label for="SimplifyText">تبسيط النص.</label>
        </fieldset>

        <fieldset id="text_fieldset">
            <legend>النص:</legend>
            <textarea rows="5"
                id="input_text">   ذَهَـــبَ           زَيْــــدٌ إِلَى اَلـسُّوقِ فَلَمْ يَعْثُرْ عَلَى . . . . مَا كَانَ يُرِيدُ , وَكَانَ الْـجَوُّ حِينَهَا جَمِيلاً , وَ     الـسَّمَاءُ صَافِيَةً،والْهَوَاءُ نَقِيًا  ; فَذَهَبَ إِلَى اَلْبَحْرِ، وَجَلَسَ يَسْتَمْتِعُ بِالْغُرُوبِ عند مكان اسمه  : " الجُرْف " . </textarea>
            <button type="button" id="execute">تنفيذ</button>
        </fieldset>

        <fieldset id="result_fieldset">
            <legend>الناتج:</legend>
            <textarea id="result_text" rows="5"></textarea>
            <!-- <button type="button" onclick="">نسخ</button> -->
        </fieldset>

        <fieldset id="tashkil_fieldset">
            <legend>رموز التشكيل:</legend>
            <textarea id="tashkil_text" rows="5" dir="ltr"></textarea>
        </fieldset>
    </div>

    <script type="module">
        import { ArBasic } from "./js/ArBasic.js";

        window.onload = function () {
            const ops = document.getElementsByName("options");
            const tashkilFieldset = document.getElementById("tashkil_fieldset");
            let selectedOP = 0;


            function CheckTashkilFieldsetDisplay(selectedOP) {
                switch (selectedOP) {
                    case 8:
                    case 9:
                        tashkilFieldset.style.display = 'block';
                        break;
                    default:
                        tashkilFieldset.style.display = 'none';
                }
            }

            for (let i = 0; i < ops.length; i++) {
                const op = ops[i];

                op.addEventListener("change", function () {
                    selectedOP = parseInt(this.value, 10);
                    CheckTashkilFieldsetDisplay(selectedOP);
                });

                if (op.checked) {
                    selectedOP = parseInt(op.value, 10);
                    CheckTashkilFieldsetDisplay(selectedOP);
                }
            }

            const inputText = document.getElementById("input_text");
            const resultText = document.getElementById("result_text");
            const tashkilText = document.getElementById("tashkil_text");

            document.getElementById("execute").addEventListener("click", function () {
                resultText.value = (function () {
                    switch (selectedOP) {
                        case 0:
                            return ArBasic.ImproveText(inputText.value);
                        case 1:
                        case 3:
                            return ArBasic.RemoveTashkil(inputText.value, (selectedOP === 3));
                        case 2:
                            return ArBasic.ReduceTashkil(inputText.value);
                        case 4:
                        case 5:
                            return ArBasic.LastTashkil(inputText.value, (selectedOP === 4));
                        case 6:
                            return ArBasic.RemoveTatweel(inputText.value);
                        case 8:
                            {
                                const ret = ArBasic.EncodeTashkil(inputText.value);
                                tashkilText.value = ret.EncodedTashkil;
                                return ret.StrippedText;
                            }
                        case 9:
                            return ArBasic.DecodeTashkil(inputText.resultText, tashkilText.value);
                        case 10:
                            return ArBasic.SeparateLamAlef(inputText.value);
                        case 11:
                            return ArBasic.UnifyLetters(inputText.value);
                        case 12:
                            return ArBasic.SimplifyText(inputText.value);
                        default:
                            return "";
                    }
                })();
            });
        };
    </script>
</body>

</html>
